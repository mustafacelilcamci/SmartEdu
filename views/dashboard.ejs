<%- include('partials/_header'); %>

<%- include('partials/_navigation'); %>

<% if(user) { %>

<% if(user.role==='student' ) { %>

<div class="all-title-box">
	<div class="container text-center">
		<h1>
			<%= user.name %><span class="m_1">STUDENT</span>
		</h1>
	</div>
</div>

<div id="overviews" class="section wb">
	<div class="container">
		<div class="row">
			<div class="col-lg-12 blog-post-single">
				<div class="blog-author">
					<div class="author-bio">
						<h3 class="author_name"><a href="#"> Courses Enrolled by:  <%= user.name %></a></h3>
					</div>
				</div>
			</div>
		</div>
		<div class="row mt-5">
			<% for (let i=0; i< user.courses.length; i++) { %>
			<div class="col-lg-6 col-md-6 col-12">
				<div class="course-item mb-5">
					<div class="image-blog">
						<img src="/images/blog_1.jpg" alt="" class="img-fluid">
					</div>
					<div class="course-br">
						<div class="course-title">
							<h2><a href="/courses/<%= user.courses[i].slug %>" title=""><%= user.courses[i].name %> </a></h2>
						</div>
						<div class="course-desc">
							<p><%= user.courses[i].description %> </p>
							<form method="POST" action="/courses/release">
								<input type="hidden" name="course_id" value="<%= user.courses[i]._id %>">
								<button class="btn btn-lg btn-danger text-white"><span>RELEASE</span></button>
							</form>
						</div>
					</div>
				</div>
			</div>
			<% } %>
		</div>
	</div>
</div>

<% } %>

<% if(user.role==='teacher' ) { %>
<!-- TEACHER SECTION -- Bu kısımda değişiklik yapılmadı, önceki hâli korunuyor -->

<% } %>

<% if(user.role==='admin' ) { %>
<div class="all-title-box">
	<div class="container text-center">
		<h1>
			<%= user.name %><span class="m_1">ADMIN</span>
		</h1>
	</div>
</div>

<div id="overviews" class="section wb">
  <div class="container">
    <div class="row mt-5">
      <h2>Users</h2>

      <table class="table table-bordered">
        <thead class="thead-dark">
          <tr>
            <th scope="col">Email</th>
            <th scope="col">Role</th>
            <th scope="col">Delete</th>
          </tr>
        </thead>
        <tbody>
          <% for (let i = 0; i < users.length; i++) { %>
            <tr>
              <td><%= users[i].email %></td>
              <td><%= users[i].role %></td>
              <td>
                <a href="/users/<%= users[i]._id %>?_method=DELETE"
                   onclick="return confirm('ARE YOU SURE?')"
                   class="btn btn-danger rounded-0 text-white">
                  Delete
                </a>
              </td>
            </tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>

		

			<div class="col-md-12">
				<div class="table-responsive">
					<table class="table table-bordered table-hover">
						<thead class="thead-dark">
							<tr>
								<th scope="col">Name</th>
								<th scope="col">Slug</th>
								<th scope="col">Delete</th>
							</tr>
						</thead>
						<tbody>
							<% if (categories.length === 0) { %>
							<tr><td colspan="3" class="text-center">No categories found.</td></tr>
							<% } else { %>
							<% categories.forEach(category => { %>
							<tr>
								<td><%= category.name %></td>
								<td><%= category.slug %></td>
								<td>
									
  <a href="/categories/<%= category._id %>?_method=DELETE" 
     onclick="return confirm('Are you sure you want to delete this category?')" 
     class="btn btn-sm btn-danger">Delete</a>

  <a href="/categories/<%= category._id %>/edit" 
     class="btn btn-sm btn-primary ml-1">Edit</a>
</td>

									
							</tr>
							<% }); %>
							<% } %>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>
<% } %>

<% } %>

<%- include('partials/_footer'); %>
